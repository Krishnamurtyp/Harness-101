pipeline:
  name: NodeJS Hello World CI
  identifier: nodejs_hello_world_ci
  projectIdentifier: Harness101Integration  # Updated to match Harness URL
  orgIdentifier: default                    # Already correct
  properties:
    ci:
      codebase:
        connectorRef: GitHub_Krishnamurtyp_Harness101
        repoName: Krishnamurtyp/Harness-101
        build: <+codebase.branch>
  stages:
    - stage:
        name: Build and Test
        identifier: build_and_test
        type: CI
        spec:
          execution:
            steps:
              - step:
                  type: Run
                  name: Install Dependencies
                  identifier: install_dependencies
                  spec:
                    shell: Sh
                    command: npm install
              - step:
                  type: Run
                  name: Run Tests
                  identifier: run_tests
                  spec:
                    shell: Sh
                    command: npm test
              - step:
                  type: Run
                  name: Start App
                  identifier: start_app
                  spec:
                    shell: Sh
                    command: |
                      npm start & sleep 5
          infrastructure:
            type: Cloud
            spec: {}
